<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    <title>Angular系列学习笔记（二）—— 基于gulp构建Angular单页面应用 | 小青年博客 | 看似寻常最奇崛，成如容易却艰辛。</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="angular,gulp,angular-ui-router,angular-material">
    <meta name="description" content="前言构建打包工具之前一直是使用 webpack（歪脖帕克，毕竟尤大推荐的工具），由于公司这边是使用gulp，为了和公司同步，私下还是要学习学习，毕竟懂点万一需要和老大交流也不至于说有啥问题，这篇文章将会以零基础的角度去写一下基于gulp搭建angular的工程，借这个机会顺便重构一下自己的博客。 gulp基础入门在开工之前确保自己已经安装了node环境，没有安装的自行安装好node，安装的时候默认">
<meta name="keywords" content="angular,gulp,angular-ui-router,angular-material">
<meta property="og:type" content="article">
<meta property="og:title" content="Angular系列学习笔记（二）—— 基于gulp构建Angular单页面应用">
<meta property="og:url" content="https://zhaomenghuan.github.io/2017/04/01/Angular系列学习笔记（二）—基于gulp构建Angular单页面应用/index.html">
<meta property="og:site_name" content="小青年博客">
<meta property="og:description" content="前言构建打包工具之前一直是使用 webpack（歪脖帕克，毕竟尤大推荐的工具），由于公司这边是使用gulp，为了和公司同步，私下还是要学习学习，毕竟懂点万一需要和老大交流也不至于说有啥问题，这篇文章将会以零基础的角度去写一下基于gulp搭建angular的工程，借这个机会顺便重构一下自己的博客。 gulp基础入门在开工之前确保自己已经安装了node环境，没有安装的自行安装好node，安装的时候默认">
<meta property="og:updated_time" content="2017-05-03T16:13:59.548Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Angular系列学习笔记（二）—— 基于gulp构建Angular单页面应用">
<meta name="twitter:description" content="前言构建打包工具之前一直是使用 webpack（歪脖帕克，毕竟尤大推荐的工具），由于公司这边是使用gulp，为了和公司同步，私下还是要学习学习，毕竟懂点万一需要和老大交流也不至于说有啥问题，这篇文章将会以零基础的角度去写一下基于gulp搭建angular的工程，借这个机会顺便重构一下自己的博客。 gulp基础入门在开工之前确保自己已经安装了node环境，没有安装的自行安装好node，安装的时候默认">
    
        <link rel="alternate" type="application/atom+xml" title="小青年博客" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>
</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.png">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">赵梦欢</h5>
          <a href="mailto:zhaomenghuan@foxmail.com" title="zhaomenghuan@foxmail.com" class="mail">zhaomenghuan@foxmail.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                首页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                归档
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                分类
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://zhaomenghuan.github.io/content.json" target="_blank" >
                <i class="icon icon-lg icon-th-large"></i>
                API
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/zhaomenghuan" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                GitHub
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://segmentfault.com/u/zhaomenghuan" target="_blank" >
                <i class="icon icon-lg icon-link"></i>
                Segmentfault
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="http://www.jianshu.com/u/de1f0b8eaf18" target="_blank" >
                <i class="icon icon-lg icon-book"></i>
                简书
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Angular系列学习笔记（二）—— 基于gulp构建Angular单页面应用</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Angular系列学习笔记（二）—— 基于gulp构建Angular单页面应用</h1>
        <h5 class="subtitle">
            
                <time datetime="2017-03-31T16:00:00.000Z" itemprop="datePublished" class="page-time">
  2017-04-01
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Angular系列学习笔记/">Angular系列学习笔记</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#前言"><span class="post-toc-number">1.</span> <span class="post-toc-text">前言</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#gulp基础入门"><span class="post-toc-number">2.</span> <span class="post-toc-text">gulp基础入门</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#基本流程"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">基本流程</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#创建package-json文件"><span class="post-toc-number">2.1.1.</span> <span class="post-toc-text">创建package.json文件</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#安装-gulp"><span class="post-toc-number">2.1.2.</span> <span class="post-toc-text">安装 gulp</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#创建-gulpfile-js-文件"><span class="post-toc-number">2.1.3.</span> <span class="post-toc-text">创建 gulpfile.js 文件</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#运行gulp"><span class="post-toc-number">2.1.4.</span> <span class="post-toc-text">运行gulp</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#gulpfile-js配置说明"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">gulpfile.js配置说明</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#创建具有热更新的本地服务-——-browser-sync"><span class="post-toc-number">2.2.1.</span> <span class="post-toc-text">创建具有热更新的本地服务 —— browser-sync</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Jade-模板文件转换为-HTML-文件-——-gulp-jade"><span class="post-toc-number">2.2.2.</span> <span class="post-toc-text">Jade 模板文件转换为 HTML 文件 —— gulp-jade</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#less-文件转换成css文件-——-gulp-less"><span class="post-toc-number">2.2.3.</span> <span class="post-toc-text">less 文件转换成css文件 —— gulp-less</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#压缩图片——gulp-imagemin"><span class="post-toc-number">2.2.4.</span> <span class="post-toc-text">压缩图片——gulp-imagemin</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#从命令行传递参数设置项目开发模式"><span class="post-toc-number">2.2.5.</span> <span class="post-toc-text">从命令行传递参数设置项目开发模式</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#项目实战"><span class="post-toc-number">3.</span> <span class="post-toc-text">项目实战</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ui-router使用指南"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">ui-router使用指南</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#stateProvider"><span class="post-toc-number">3.1.1.</span> <span class="post-toc-text">$stateProvider</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#urlRouterProvider"><span class="post-toc-number">3.1.2.</span> <span class="post-toc-text">$urlRouterProvider</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#urlRouter"><span class="post-toc-number">3.1.3.</span> <span class="post-toc-text">$urlRouter</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#state"><span class="post-toc-number">3.1.4.</span> <span class="post-toc-text">$state</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#三种常用的方式激活路由状态"><span class="post-toc-number">3.1.5.</span> <span class="post-toc-text">三种常用的方式激活路由状态</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#html5模式-or-Hashbang"><span class="post-toc-number">3.1.6.</span> <span class="post-toc-text">html5模式 or Hashbang</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#参考"><span class="post-toc-number">4.</span> <span class="post-toc-text">参考</span></a></li></ol>
        </nav>
    </aside>
    
<article id="post-Angular系列学习笔记（二）—基于gulp构建Angular单页面应用"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Angular系列学习笔记（二）—— 基于gulp构建Angular单页面应用</h1>
        <div class="post-meta">
            <time class="post-time" title="2017-04-01 00:00:00" datetime="2017-03-31T16:00:00.000Z"  itemprop="datePublished">2017-04-01</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Angular系列学习笔记/">Angular系列学习笔记</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


            

        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>构建打包工具之前一直是使用 webpack（歪脖帕克，毕竟尤大推荐的工具），由于公司这边是使用gulp，为了和公司同步，私下还是要学习学习，毕竟懂点万一需要和老大交流也不至于说有啥问题，这篇文章将会以零基础的角度去写一下基于gulp搭建angular的工程，借这个机会顺便重构一下自己的博客。</p>
<h2 id="gulp基础入门"><a href="#gulp基础入门" class="headerlink" title="gulp基础入门"></a>gulp基础入门</h2><p>在开工之前确保自己已经安装了node环境，没有安装的自行安装好node，安装的时候默认会安装npm包管理器。安装好了通过下列的命令检查版本：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ node -v</div><div class="line">v7<span class="number">.5</span><span class="number">.0</span></div><div class="line">$ npm -v</div><div class="line"><span class="number">4.1</span><span class="number">.2</span></div></pre></td></tr></table></figure></p>
<p>然后看看gulp的文档和文章取取经开始我们今天的工作：<br><a href="https://nodejs.org/en/" target="_blank" rel="external">node官网</a><br><a href="https://www.npmjs.com/" target="_blank" rel="external">npm官网</a><br><a href="http://www.gulpjs.com.cn/docs/getting-started/" target="_blank" rel="external">gulp中文网入门指南</a><br><a href="https://www.w3ctech.com/topic/134" target="_blank" rel="external">Gulp开发教程（翻译）</a></p>
<h3 id="基本流程"><a href="#基本流程" class="headerlink" title="基本流程"></a>基本流程</h3><h4 id="创建package-json文件"><a href="#创建package-json文件" class="headerlink" title="创建package.json文件"></a>创建package.json文件</h4><p>新建一个文件夹开始，这里我以zhaomenghuan-blog，然后然后命令行进入项目目录：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># 创建 package.json 文件，直接一路回车就好</div><div class="line">npm init</div></pre></td></tr></table></figure></p>
<p>这是在创建一个 package.json 文件，定义了这个项目所需要的各种模块，以及项目的配置信息（比如名称、版本、许可证等元数据）。详细介绍可以看阮一峰老师的这篇文章：<a href="http://javascript.ruanyifeng.com/nodejs/packagejson.html" target="_blank" rel="external">package.json文件</a>。</p>
<h4 id="安装-gulp"><a href="#安装-gulp" class="headerlink" title="安装 gulp"></a>安装 gulp</h4><p>全局安装 gulp<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install gulp -g</div></pre></td></tr></table></figure></p>
<p>作为项目的开发依赖（devDependencies）安装：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install gulp -D</div></pre></td></tr></table></figure></p>
<p>这两者的区别可以看看这篇文章：<a href="http://zhaomenghuan.github.io/#!/blog/20161115">npm 常用命令详解</a>。执行完这一步，目录下就多了一个node_modules文件夹，里面都是依赖的模块。一般来说，我们可能会在其它项目中使用的工具，如这里的gulp我们会先进行全局按照，这样会在本地有一个“仓库”，以后再用的时候直接下载到项目中岂可，避免每次不必要的下载等待。另外，dependencies字段指定了项目运行所依赖的模块，devDependencies指定项目开发所需要的模块。下载模块的时候注意区分，分清楚依赖模块的差异有助于我们后期优化代码，避免不必要的模块引入到项目最终源码中，造成代码打包过大的问题。</p>
<h4 id="创建-gulpfile-js-文件"><a href="#创建-gulpfile-js-文件" class="headerlink" title="创建 gulpfile.js 文件"></a>创建 gulpfile.js 文件</h4><p>在项目根目录下创建一个名为 gulpfile.js 的文件：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'default'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">// 将你的默认的任务代码放在这</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h4 id="运行gulp"><a href="#运行gulp" class="headerlink" title="运行gulp"></a>运行gulp</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gulp 或 gulp <span class="keyword">default</span></div></pre></td></tr></table></figure>
<p>默认的名为 default 的任务（task）将会被运行，在这里，这个任务并未做任何事情。<br>想要单独执行特定的任务（task），请输入 gulp <task> <othertask>，例如在gulpfile.js里面添加如下代码：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">gulp.task(<span class="string">'console'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'hello gulp'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></othertask></task></p>
<p>然后执行<code>gulp console</code>就会输入<code>hello gulp</code>。</p>
<p>很显然我们通过一些命令就可以执行一下任务（task），那么接下来的重点就是写task相关的代码。</p>
<h3 id="gulpfile-js配置说明"><a href="#gulpfile-js配置说明" class="headerlink" title="gulpfile.js配置说明"></a>gulpfile.js配置说明</h3><p>上面的流程只是对gulp基本流程入门，但是对于gulp的强大功能还没有直观的感觉，下面我们通过常用的几段配置看看配置的基本方法。需要说明的是，在使用插件之前我们都需要先安装相关的模块。</p>
<h4 id="创建具有热更新的本地服务-——-browser-sync"><a href="#创建具有热更新的本地服务-——-browser-sync" class="headerlink" title="创建具有热更新的本地服务 —— browser-sync"></a>创建具有热更新的本地服务 —— browser-sync</h4><p>参考文档<a href="http://www.gulpjs.com.cn/docs/recipes/server-with-livereload-and-css-injection/" target="_blank" rel="external">拥有实时重载（live-reloading）和 CSS 注入的服务器</a>这篇文章可知，使用 <a href="http://browsersync.io/" target="_blank" rel="external">BrowserSync</a> 和 gulp，你可以轻松地创建一个开发服务器，然后同一个 WiFi 中的任何设备都可以方便地访问到。BrowserSync 同时集成了 live-reload 所以不需要另外做配置了。</p>
<p>安装browser-sync模块：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install browser-sync -D</div></pre></td></tr></table></figure></p>
<p>可以通过gulp.watch监听文件变动并且自动刷新，如下：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"><span class="keyword">var</span> sass = <span class="built_in">require</span>(<span class="string">'gulp-ruby-sass'</span>);</div><div class="line"><span class="keyword">var</span> browserSync = <span class="built_in">require</span>(<span class="string">'browser-sync'</span>);</div><div class="line"><span class="keyword">var</span> reload = browserSync.reload;</div><div class="line"></div><div class="line">gulp.task(<span class="string">'sass'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> sass(<span class="string">'scss/styles.scss'</span>)</div><div class="line">    .pipe(gulp.dest(<span class="string">'app/css'</span>))</div><div class="line">    .pipe(reload(&#123; <span class="attr">stream</span>:<span class="literal">true</span> &#125;));</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// 监视 Sass 文件的改动，如果发生变更，运行 'sass' 任务，并且重载文件</span></div><div class="line">gulp.task(<span class="string">'serve'</span>, [<span class="string">'sass'</span>], <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  browserSync(&#123;</div><div class="line">    <span class="attr">server</span>: &#123;</div><div class="line">      <span class="attr">baseDir</span>: <span class="string">'app'</span></div><div class="line">    &#125;</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">  gulp.watch(<span class="string">'app/scss/*.scss'</span>, [<span class="string">'sass'</span>]);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h4 id="Jade-模板文件转换为-HTML-文件-——-gulp-jade"><a href="#Jade-模板文件转换为-HTML-文件-——-gulp-jade" class="headerlink" title="Jade 模板文件转换为 HTML 文件 —— gulp-jade"></a>Jade 模板文件转换为 HTML 文件 —— gulp-jade</h4><p>我们可以通过gulp-jade插件将jade模板转成html文件，如下：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> source = &#123;</div><div class="line">    <span class="attr">templates</span>: [</div><div class="line">        &#123; <span class="attr">src</span>: <span class="string">'./src/index.jade'</span>, <span class="attr">dist</span>: <span class="string">'./app/'</span>&#125;,</div><div class="line">        &#123; <span class="attr">src</span>: <span class="string">'./src/components/**/*.jade'</span>, <span class="attr">dist</span>: <span class="string">'./app/components/'</span>&#125;</div><div class="line">    ]</div><div class="line">&#125;;</div><div class="line"></div><div class="line">gulp.task(<span class="string">'templates'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    source.templates.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123;</div><div class="line">        gulp.src(item.src)</div><div class="line">            .pipe(jade(&#123;</div><div class="line">                <span class="attr">pretty</span>: <span class="literal">true</span></div><div class="line">            &#125;))</div><div class="line">            .pipe(gulp.dest(item.dist))</div><div class="line">            .pipe(reload(&#123;</div><div class="line">                <span class="attr">stream</span>:<span class="literal">true</span></div><div class="line">             &#125;));</div><div class="line">    &#125;)</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h4 id="less-文件转换成css文件-——-gulp-less"><a href="#less-文件转换成css文件-——-gulp-less" class="headerlink" title="less 文件转换成css文件 —— gulp-less"></a>less 文件转换成css文件 —— gulp-less</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"><span class="keyword">var</span> less = <span class="built_in">require</span>(<span class="string">'gulp-less'</span>);             <span class="comment">// 解析less</span></div><div class="line"><span class="keyword">var</span> minifycss = <span class="built_in">require</span>(<span class="string">'gulp-minify-css'</span>); <span class="comment">// 压缩css</span></div><div class="line"><span class="keyword">var</span> uglify = <span class="built_in">require</span>(<span class="string">"gulp-uglify"</span>);         <span class="comment">// 压缩代码</span></div><div class="line"><span class="keyword">var</span> concat = <span class="built_in">require</span>(<span class="string">"gulp-concat"</span>);         <span class="comment">// 合并文件</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> source = &#123;</div><div class="line">    <span class="attr">styles</span>: [</div><div class="line">        <span class="string">'./src/index.less'</span>,</div><div class="line">        <span class="string">'./src/components/**/*.less'</span>,</div><div class="line">        <span class="string">'./src/pages/**/*.less'</span></div><div class="line">    ]</div><div class="line">&#125;;</div><div class="line"></div><div class="line">gulp.task(<span class="string">'styles:source'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> gulp.src(source.styles) <span class="comment">// 压缩的文件</span></div><div class="line">        .pipe(less())</div><div class="line">        .pipe(minifycss()) <span class="comment">// 执行压缩</span></div><div class="line">        .pipe(concat(<span class="string">'all.min.css'</span>))</div><div class="line">        .pipe(gulp.dest(<span class="string">'./app/css/'</span>)) <span class="comment">//输出到指定目录</span></div><div class="line">        .pipe(reload(&#123;</div><div class="line">            <span class="attr">stream</span>:<span class="literal">true</span></div><div class="line">        &#125;));</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h4 id="压缩图片——gulp-imagemin"><a href="#压缩图片——gulp-imagemin" class="headerlink" title="压缩图片——gulp-imagemin"></a>压缩图片——gulp-imagemin</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"><span class="keyword">var</span> imagemin = <span class="built_in">require</span>(<span class="string">'gulp-imagemin'</span>);     <span class="comment">// 图片压缩</span></div><div class="line"><span class="keyword">var</span> source = &#123;</div><div class="line">    <span class="attr">images</span>: &#123;</div><div class="line">        <span class="attr">src</span>: <span class="string">'./src/assets/images/*'</span>,</div><div class="line">        <span class="attr">dist</span>: <span class="string">'./app/assets/images'</span></div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">gulp.task(<span class="string">'images'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    gulp.src(source.images.src)</div><div class="line">        .pipe(imagemin(&#123;</div><div class="line">            <span class="attr">optimizationLevel</span>: <span class="number">7</span></div><div class="line">        &#125;))</div><div class="line">        .pipe(gulp.dest(source.images.dist));</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h4 id="从命令行传递参数设置项目开发模式"><a href="#从命令行传递参数设置项目开发模式" class="headerlink" title="从命令行传递参数设置项目开发模式"></a>从命令行传递参数设置项目开发模式</h4><p>项目开发环境下我们经常写很多<code>console.log</code>调试程序，在上线的时候我们又不想手动删除这些调试日志，这时候我们可以通过插件来完成。我们需要来配置两个环境：</p>
<ul>
<li>DEV 模式：在开发环境中，为了方便 debug，JavaScript 通常不做压缩和混淆；</li>
<li>PROD 模式：上生产环境时，JavaScript 必须并合压缩、混淆并成一个文件，同时需要去除所有的 log 输出语句。</li>
</ul>
<p>我们可以通过命令行传递参数说明是什么模式，我们可以通过官方的例子<a href="http://www.gulpjs.com.cn/docs/recipes/pass-arguments-from-cli/" target="_blank" rel="external">从命令行传递参数</a>学习如何使用。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// npm install --save-dev gulp gulp-if gulp-uglify minimist gulp-strip-debug</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"><span class="keyword">var</span> gulpif = <span class="built_in">require</span>(<span class="string">'gulp-if'</span>);</div><div class="line"><span class="keyword">var</span> uglify = <span class="built_in">require</span>(<span class="string">'gulp-uglify'</span>);</div><div class="line"><span class="keyword">var</span> stripDebug = <span class="built_in">require</span>(<span class="string">'gulp-strip-debug'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> minimist = <span class="built_in">require</span>(<span class="string">'minimist'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> knownOptions = &#123;</div><div class="line">  <span class="attr">string</span>: <span class="string">'env'</span>,</div><div class="line">  <span class="attr">default</span>: &#123; <span class="attr">env</span>: process.env.NODE_ENV || <span class="string">'production'</span> &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> options = minimist(process.argv.slice(<span class="number">2</span>), knownOptions);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'scripts'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'**/*.js'</span>)</div><div class="line">    .pipe(gulpif(options.env === <span class="string">'production'</span>, uglify())) <span class="comment">// 仅在生产环境时候进行压缩</span></div><div class="line">    .pipe(gulpif(options.env === <span class="string">'production'</span>, stripDebug())) <span class="comment">// 去掉console.log</span></div><div class="line">    .pipe(gulp.dest(<span class="string">'dist'</span>));</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>默认是development环境下，如果想使用production环境可以通过如下命令运行 gulp：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ gulp scripts --env development</div></pre></td></tr></table></figure></p>
<p>每次在命令行输入参数容易出错，为了方便我们可以将脚本写在package.json中的scripts字段里面：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="string">"scripts"</span>: &#123;</div><div class="line">    <span class="string">"dev"</span>: <span class="string">"gulp serve --env development"</span>,</div><div class="line">    <span class="string">"build"</span>: <span class="string">"gulp serve --env production"</span></div><div class="line"> &#125;,</div></pre></td></tr></table></figure></p>
<p>然后执行<code>npm run dev</code>和<code>npm run build</code>命令就可以。</p>
<p>对于新手而言，可能理解这个流程更重要，这个流程跑通了，接下来无非就是看文档入门了，关于gulp后文不再一步步赘述，而是直接给出gulpfile.js的代码。这里我们可以看出来gulp强大的功能得以实现，依赖于各种方便的插件，与webpack中提供的各种loader十分类似。可见要想完成各种负责的功能，需要对常用插件进行学习，我们可以通过这里的例子学习相关的插件使用方法：<a href="http://www.gulpjs.com.cn/docs/recipes/" target="_blank" rel="external">gulp 技巧集</a>。</p>
<h2 id="项目实战"><a href="#项目实战" class="headerlink" title="项目实战"></a>项目实战</h2><p>上面的例子对于我们搭建一个基础工程足够了，下面我们通过一个实际例子来说明。</p>
<p>项目结构：<br> <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">├── node_modules <span class="comment">// 打包过程中依赖的包</span></div><div class="line">├── package.json <span class="comment">// 包含各种所需模块以及项目的配置信息</span></div><div class="line">├── gulpfile.js <span class="comment">// 打包配置文件</span></div><div class="line">├── app <span class="comment">// 打包之后最终部署到服务器上的文件（名称自定义）</span></div><div class="line">├── src  <span class="comment">// 资源文件（名称自定义）</span></div><div class="line">    ├── components <span class="comment">// 自定义全局组件</span></div><div class="line">        ├── pageloading （如：页面切换loading）</div><div class="line">        ...</div><div class="line">    ├── pages <span class="comment">// 页面路由组件</span></div><div class="line">        ├── index</div><div class="line">            ├── index.jade 默认路由视图</div><div class="line">            ├── index.controller.js 默认路由控制器</div><div class="line">            └── index.config.js 默认视图路由配置</div><div class="line">        ├── blog</div><div class="line">        ···</div><div class="line">    ├── assets <span class="comment">// 静态资源</span></div><div class="line">        ├── images <span class="comment">// 图片资源</span></div><div class="line">    ├── app.module.js <span class="comment">// 全局模块</span></div><div class="line">    ├── index.jade <span class="comment">// 入口视图模板</span></div><div class="line">    └── index.less <span class="comment">// 入口视图样式</span></div><div class="line">└── vendor.config.js <span class="comment">// 依赖的库配置文件（自定义）</span></div></pre></td></tr></table></figure></p>
<p>本文工程地址：<a href="https://github.com/zhaomenghuan/learn-angular/tree/master/project/angular-material" target="_blank" rel="external">learn-angular =&gt; angular-material</a></p>
<h3 id="ui-router使用指南"><a href="#ui-router使用指南" class="headerlink" title="ui-router使用指南"></a>ui-router使用指南</h3><p>我们知道一个大型的单页面应用离不开路由，angular自带了ngRouter，但是我们常用的是angularUI的ui-router，这是因为UI-Router有两个重要的特性：</p>
<ul>
<li>多样化视图</li>
<li>嵌入式视图</li>
</ul>
<p>ui-router支持多样化视图，并且每一个视图都有自己相应的控制，所以每个区块都是封装好，可以复用到整个应用程序需要的地方，这就意味着我们可以实现视图的复用和分治。ui-router 引进了状态机设计模式，抽象高于传统的路由。路由成了状态，URL就成了状态的一个简单属性。</p>
<p>对于ui-router最好的学习教程就是<a href="https://github.com/angular-ui/ui-router/wiki" target="_blank" rel="external">ui-router 官方wiki</a>，我们下面会来讲解一下新手常见的几个问题。</p>
<p>下载：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install angular-ui-router -S</div></pre></td></tr></table></figure></p>
<p>引入依赖:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> app = angular.module(<span class="string">'app'</span>, [<span class="string">'ui.router'</span>]);</div></pre></td></tr></table></figure></p>
<blockquote>
<p>注意：是ui.router不是ui-router!</p>
</blockquote>
<h4 id="stateProvider"><a href="#stateProvider" class="headerlink" title="$stateProvider"></a>$stateProvider</h4><blockquote>
<p>处理路由状态的服务，路由的状态反映了该项在应用程序中的位置，描述了在当前状态下UI是应该怎么样的，并且该做什么。</p>
</blockquote>
<p><strong>依赖：</strong>$urlRouterProvider $urlMatcherFactoryProvider</p>
<p><strong>decorator(name,func)：</strong>通过内部的$stateProvider以扩展或者重写状态生成器。可用于添加ui-router的自定义功能，例如，基于状态名称推断templateUrl。<br><strong>警告：</strong>因为生成器的函数执行顺序的不确定，decorator不应该相互依赖。<br><strong>参数：</strong><br>name：需要修改的生成函数名称。<br>func：负责修改生成器函数的函数。</p>
<p><strong>state(name,stateConfig)：</strong>注册一个状态，并给定其配置。<br><strong>参数：</strong><br>name：状态的名称。<br>stateConfig：状态配置对象。配置具有以下各项属性：<br>template： string/function，html模板字符串，或者一个返回html模板字符串的函数；<br>templateUrl：string/function，模板路径的字符串，或者返回模板路径字符串的函数；<br>templateProvider：function，返回html模板字符串或模板路径的服务；<br>controller：string/function，新注册一个控制器函数或者一个已注册的控制器的名称字符串；<br>controllerProvider：function，返回控制器或者控制器名称的服务；<br>controllerAs：string，控制器别名；<br>parent：string/object，手动指定该状态的父级；<br>resolve：object，将会被注入controller去执行的函数，<string,function>形式。<br>url：string，当前状态的对应url；<br>views：object，视图展示的配置，<string,object>形式；<br>abstract：boolean，一个永远不会被激活的抽象的状态，但可以给其子级提供特性的继承。默认是true；<br>onEnter：function，当进入一个状态后的回调函数；<br>onExit：function，当退出一个状态后的回调函数；<br>reloadOnSearch：boolean，如果为false，那么当一个search/query参数改变时不会触发相同的状态，用于当你修改$location.search()的时候不想重新加载页面。默认为true；<br>data：object，任意对象数据，用于自定义配置。继承父级状态的data属性。换句话说，通过原型继承可以达到添加一个data数据从而整个树结构都能获取到；<br>params：url里的参数值，通过它可以实现页面间的参数传递。</string,object></string,function></p>
<h4 id="urlRouterProvider"><a href="#urlRouterProvider" class="headerlink" title="$urlRouterProvider"></a>$urlRouterProvider</h4><blockquote>
<p>$urlRouterProvider 在这里有两个主要目的：一是建立一个默认路由，用于管理未知的URL（统一跳转到某处）；二是监听浏览器地址栏URL的变化，重定向到路由定义的状态中。总之，$urlRouterProvider让我们处理状态机抽象的$stateProvider没有检测到的情况。</p>
</blockquote>
<p>$urlRouterProvider负责监听$location.当$location变化的时候，$urlRouterProvider开始在一个规则的列表中一个个的查找，直到找到匹配的值。$urlRouterProvider用于在后端指定url的状态配置。所有的url被编译成UrlMatcher对象。<br><strong>依赖：</strong> $urlMatcherFactoryProvider   $locationProvider</p>
<p><strong>deferIntercept(defer) ：</strong>禁用（或启用）延迟location变化的拦截。<br>如果你想定制与URL同步的行为（例如，你需要保持当前的URL去并且推迟一个变化），那么在配置的时候使用这个方法。<br><strong>参数：</strong><br>defer：boolean，确定是禁止还是启用该拦截。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">angular.module(<span class="string">'app'</span>,[<span class="string">'ui.router'</span>]).config([<span class="string">"$urlRouterProvider"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">     $urlRouterProvider.deferIntercept(defer); <span class="comment">// defer = true/false </span></div><div class="line">&#125;])</div></pre></td></tr></table></figure></p>
<p><strong>otherwise(rule)：</strong>定义一个当请求的路径是无效路径时跳转的路径。<br> <strong>参数：</strong><br>rule：你想重定向的url路径或一个返回的网址路径的规则函数。函数传入两个参数：$injector和$location服务，而且必须返回一个string的url。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">angular.module(<span class="string">'app'</span>,[<span class="string">'ui.router'</span>]).config([<span class="string">"$urlRouterProvider"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">     $urlRouterProvider.otherwise(rule); <span class="comment">// rule = 重定向的url规则</span></div><div class="line">&#125;])</div></pre></td></tr></table></figure></p>
<p> <strong>rule(rule)： </strong>定义使用$urlRouterProvider来匹配指定的URL的规则。<br> <strong>参数： </strong><br>rule：将$injector和$location作为arguments传入的处理函数。用来返回一个string类型的url路径。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">angular.module(<span class="string">'app'</span>,[<span class="string">'ui.router'</span>]).config([<span class="string">"$urlRouterProvider"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">$urlRouterProvider</span>)</span>&#123;</div><div class="line">     $urlRouterProvider.rule(<span class="function"><span class="keyword">function</span> (<span class="params">$injector, $location</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> path = $location.path(),</div><div class="line">        normalized = path.toLowerCase();</div><div class="line">        <span class="keyword">if</span> (path !== normalized) &#123;</div><div class="line">           <span class="keyword">return</span> normalized;</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;])</div></pre></td></tr></table></figure></p>
<p><strong>when(what,handler)：</strong>为给定的URL匹配注册一个处理程序。<br><strong>参数：</strong><br>what：需要重定向的传入路径。<br>handler：你想要重定向的路径/处理程序。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">angular.module(<span class="string">'Demo'</span>, [<span class="string">'ui.router'</span>]);</div><div class="line">.config([<span class="string">"$urlRouterProvider"</span>,<span class="function"><span class="keyword">function</span> (<span class="params">$urlRouterProvider</span>) </span>&#123;</div><div class="line">  $urlRouterProvider.when($state.url, <span class="function"><span class="keyword">function</span> (<span class="params">$match, $stateParams</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> ($state.$current.navigable !== state || !equalForKeys($match, $stateParams) &#123;</div><div class="line">     $state.transitionTo(state, $match, <span class="literal">false</span>);</div><div class="line">    &#125;</div><div class="line">  &#125;);</div><div class="line">&#125;]);</div></pre></td></tr></table></figure></p>
<h4 id="urlRouter"><a href="#urlRouter" class="headerlink" title="$urlRouter"></a>$urlRouter</h4><p><strong>依赖：</strong>$location $rootScope $injector $browser</p>
<p><strong>href(urlMacther,params,options)：</strong>一个生成URL的方法，为给定的UrlMatcher返回编译后的URL，并且用提供的参数填充。<br><strong>参数：</strong><br>urlMacther：用于当作生成URL的模板的UrlMacther对象。<br>params：一个参数值的对象用来填补所需的匹配参数。<br>options：option对象，absolute-boolean，如果为true，将会生成一个绝对地址。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$bob = $urlRouter.href(<span class="keyword">new</span> UrlMatcher(<span class="string">"/about/:person"</span>), &#123;</div><div class="line">  <span class="attr">person</span>: <span class="string">"bob"</span></div><div class="line">&#125;);</div><div class="line"><span class="comment">// $bob == "/about/bob";</span></div></pre></td></tr></table></figure></p>
<p>触发更新：发生在地址栏URL变化时执行相同的更新。</p>
<h4 id="state"><a href="#state" class="headerlink" title="$state"></a>$state</h4><blockquote>
<p>$state服务负责代表状态及提供状态之间的转换。它还提供你当前的状态及上一个状态。</p>
</blockquote>
<p><strong>依赖：</strong>$rootScope $q $view $injector $resolve $stateParams $urlRouter</p>
<p><strong>get(stateOrName,context)：</strong>返回任何指定的状态或所有状态的配置对象。<br><strong>参数：</strong><br>stateOrName：如果提供此参数，返回的是指定状态的配置对象；如果不提供此参数，则返回全部状态的配置对象。<br>context：当context是一个相对的参考状态，状态会在相关上下文中检索。</p>
<p><strong>go(to,params,options)：</strong><br><strong>参数：</strong><br>to：string，即将跳转的状态。<br>params:object，跳转所带的参数。<br>options：object，可选配置对象。有 location(是否更新地址栏的url，或以什么字符串替换url)，inherit(是否继承当前url的参数)，relative(当变化相对路径：如”^,定义的状态是相对的)，notify(是否广播$stateChangeStart和$stateChangeSuccess事件)，reload(是否重新载入)。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$state.go(<span class="string">'contact.detail'</span>);</div></pre></td></tr></table></figure></p>
<p><strong>href(stateOeName,params,options)：</strong>一个URL生成方法，返回为给定的状态填充指定的参数编译后的链接。<br><strong>参数：</strong><br>stateOeName：string，你想要生成的url的状态或者状态对象。<br>params：object，一个用于填充状态需要的参数的对象。<br>options：可选配置对象。有lossy(当第一个参数url未被提供时是否继承导航的url进行构建href),inherit(是否继承当前url的参数),relative(当变化相对路径：如”^,定义的状态是相对的),absolute(是否生成绝对url)。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$state.href(<span class="string">"about.person"</span>, &#123; <span class="attr">person</span>: <span class="string">"bob"</span> &#125;)</div></pre></td></tr></table></figure></p>
<p><strong>include(stateOrName,params,options)：</strong>一个确定当前有效的状态是不是与stateOrName平级的还是其子状态。<br><strong>参数：</strong><br>stateOeName：string，部分名称，相对名称，或者通过当前状态进行全局模式查找。<br>params：object，一个参数对象。<br>options：可选配置对象。有relative。</p>
<p><strong>is(stateOrName,params,options)：</strong>与$state.include相似，只是这个针对的是全名。参数性质同上。</p>
<p><strong>reload(state)：</strong>重新载入当前状态的方法。<br><strong>参数：</strong><br>state：一个状态名称或者状态对象。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$state.reload(<span class="string">'contact.detail'</span>);</div></pre></td></tr></table></figure></p>
<p><strong>transitionTo(to,toParams,options)：</strong>过渡到一个新状态的方法。<br><strong>参数：</strong><br>to：状态名称。<br>toParams：将会发送到下一个状态的参数。<br>options：可选参数。有location，inherit，relative，notify，reload。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$state.transitionTo($state.current, $stateParams, &#123; </div><div class="line">    <span class="attr">reload</span>: <span class="literal">true</span>, <span class="attr">inherit</span>: <span class="literal">false</span>, <span class="attr">notify</span>: <span class="literal">true</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p><strong>current：</strong>获取当前路由</p>
<p><strong>$stateChangeError：</strong>路由状态变化发生错误时触发的事件。<br><strong>参数：</strong><br>event，toState，toParams，fromState，fromParams，error。</p>
<p><strong>$stateChangeStart：</strong>路由状态变化发生前触发的事件。<br><strong>参数：</strong>event，toState，toParams，fromState，fromParams。</p>
<p><strong>$stateChangeSuccess：</strong>路由状态变化正确时触发的事件。<br><strong>参数：</strong>event，toState，toParams，fromState，fromParams。</p>
<p><strong>$stateNotFound：</strong>路由状态没找到的时候触发的事件。<br><strong>参数：</strong>event，unfoundState，fromState，fromParams。</p>
<h4 id="三种常用的方式激活路由状态"><a href="#三种常用的方式激活路由状态" class="headerlink" title="三种常用的方式激活路由状态"></a>三种常用的方式激活路由状态</h4><ul>
<li>$state.go()：优先级较高的便利方式 </li>
<li>ui-sref：点击包含此指令跳转</li>
<li>url：url导航</li>
</ul>
<p><strong>ui-sref：</strong>一种将链接（<code>&lt;a&gt;</code>标签）绑定到一个状态的指令。点击该链接将触发一个可以带有可选参数的状态转换。ui-sref此指令必须绑定到<code>&lt;a&gt;</code>标签，如果该路由有对应的关联URL，其通过$state.href()自动生成和更新href属性。<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;a ui-sref="blog" ui-sref-active="active"&gt;博客&lt;/a&gt;</div><div class="line">&lt;a ui-sref="blog(&#123;id: pageId&#125;)"&gt;博客-2017&lt;/a&gt;</div></pre></td></tr></table></figure></p>
<p>ui-sref-active=”active” 该路由激活，则对应增加active样式名称，ui-sref-opts 传递参数。</p>
<h4 id="html5模式-or-Hashbang"><a href="#html5模式-or-Hashbang" class="headerlink" title="html5模式 or Hashbang"></a>html5模式 or Hashbang</h4><p>$location服务有两种用来控制地址栏URL格式的配置：Hashbang模式（默认）和HTML5模式（使用HTML5历史API）。应用会使用两种模式中相同的API，并且$location服务会使用需要的URL片段和浏览器API来帮助改变URL或者进行历史管理。</p>
{% image http://upload-images.jianshu.io/upload_images/1945738-78637b3f92e3df9c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240 'html5模式 or Hashbang' '' %}
<table>
<thead>
<tr>
<th style="text-align:center">对比</th>
<th style="text-align:center">Hashbang模式</th>
<th style="text-align:center">HTML5模式</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">配置</td>
<td style="text-align:center">默认</td>
<td style="text-align:center">{ html5Mode: true }</td>
</tr>
<tr>
<td style="text-align:center">URL格式</td>
<td style="text-align:center">所有浏览器都支持</td>
<td style="text-align:center">hashbang URLs在高级浏览器中使用regular URLs，低级浏览器使用hashbang URLs</td>
</tr>
<tr>
<td style="text-align:center"><code>&lt;a href=&quot;&quot;&gt;</code> 链接重写</td>
<td style="text-align:center">否</td>
<td style="text-align:center">是</td>
</tr>
<tr>
<td style="text-align:center">需要服务器端配置</td>
<td style="text-align:center">否</td>
<td style="text-align:center">是</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Hashbang模式(默认mode)</p>
</blockquote>
<p>使用这个模式的话，$location会在所有浏览器中使用Hashbang URLs。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$locationProvider.html5mode = <span class="literal">false</span>;</div><div class="line">$locationProvider.hashPrefix = <span class="string">'!'</span>;</div></pre></td></tr></table></figure></p>
<p>支持网络爬虫</p>
<p>你需要添加特别的meta标记在你的文档的头部才能支持对你的AJAX应用的索引。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;meta name=<span class="string">"fragment"</span> content=<span class="string">"!"</span> /&gt;</div></pre></td></tr></table></figure></p>
<p>这能让网络爬虫请求带有_escaped<em>fragment</em>形式的参数链接，这样你就能识别爬虫并且返回一个HTML的快照了。</p>
<blockquote>
<p>HTML5模式</p>
</blockquote>
<p>在HTML5模式中，$location服务的读写器和浏览器的URL地址通过HTML5历史API交互，这使你能用regular URL path并且搜索各组成部分，和hashbang是等效的。 如果浏览器不支持HTML5 历史API， $location服务会自动回退成使用hashbang URLs。你就不用担心浏览器的支持性了。$location服务总是会用最好的选择。</p>
<p>在低级浏览器中使用了regular URL -&gt; 重定向成hashbang URL<br>在现代浏览器中打开了一个hashbang URL -&gt; 重写成regular URL<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$locationProvider.html5mode = <span class="literal">true</span>;</div></pre></td></tr></table></figure></p>
<p><strong>服务器端：</strong>使用这种模式需要开启服务器端的URL重写功能，基本上你需要重写所有指向你应用的链接(如index.html)。</p>
<p><strong>相对链接：</strong>记住要检查所有的相对连接、图片、脚本等。你必须指定你主页面的base url(<base href="/my-base">)，或者你使用绝对路径也行，因为相对路径会结合文档的初始绝对路径转换成绝对路径。文档初始路径通常和应用的根路径不一样。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><blockquote>
<ul>
<li><a href="http://www.gulpjs.com.cn/docs/recipes/" target="_blank" rel="external">gulp 技巧集</a></li>
<li><a href="https://github.com/angular-ui/ui-router/wiki/Quick-Reference" target="_blank" rel="external">ui-router wiki</a></li>
<li><a href="http://www.jianshu.com/p/35c0acdea86c" target="_blank" rel="external">UI-Router:为什么开发者都不喜欢Angular.js内置的路由</a></li>
<li><a href="http://www.cnblogs.com/ys-ys/p/5052660.html" target="_blank" rel="external">AngularJs ui-router 路由的简单介绍</a></li>
<li><a href="http://www.angularjs.cn/A00M" target="_blank" rel="external">AngularJS开发指南27：使用$location</a></li>
</ul>
</blockquote>

        </div>

        <blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2017-05-03T16:13:59.548Z" itemprop="dateUpdated">2017-05-04 00:13:59</time>
</span><br>


        
        转载需标注本文原始地址：<a href="/2017/04/01/Angular系列学习笔记（二）—基于gulp构建Angular单页面应用/" target="_blank" rel="external">https://zhaomenghuan.github.io/2017/04/01/Angular系列学习笔记（二）—基于gulp构建Angular单页面应用/</a>
        
    </div>
    <footer>
        <a href="https://zhaomenghuan.github.io">
            <img src="/img/avatar.png" alt="赵梦欢">
            赵梦欢
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/angular/">angular</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/angular-material/">angular-material</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/angular-ui-router/">angular-ui-router</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/gulp/">gulp</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://zhaomenghuan.github.io/2017/04/01/Angular系列学习笔记（二）—基于gulp构建Angular单页面应用/&title=《Angular系列学习笔记（二）—— 基于gulp构建Angular单页面应用》 — 小青年博客&pic=https://zhaomenghuan.github.io/img/avatar.png" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://zhaomenghuan.github.io/2017/04/01/Angular系列学习笔记（二）—基于gulp构建Angular单页面应用/&title=《Angular系列学习笔记（二）—— 基于gulp构建Angular单页面应用》 — 小青年博客&source=小青年,小青年博客,前端开发,android,技术宅,菜鸟教程,一个神奇的博客。" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://zhaomenghuan.github.io/2017/04/01/Angular系列学习笔记（二）—基于gulp构建Angular单页面应用/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Angular系列学习笔记（二）—— 基于gulp构建Angular单页面应用》 — 小青年博客&url=https://zhaomenghuan.github.io/2017/04/01/Angular系列学习笔记（二）—基于gulp构建Angular单页面应用/&via=https://zhaomenghuan.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://zhaomenghuan.github.io/2017/04/01/Angular系列学习笔记（二）—基于gulp构建Angular单页面应用/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2017/04/12/node学习之路（二）—Node.js 连接 MongoDB/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">node学习之路（二）—— Node.js 连接 MongoDB</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2017/03/06/Angular系列学习笔记（一）—聊聊angular的模块化/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Angular系列学习笔记（一）—— 聊聊angular的模块化</h4>
      </a>
    </div>
  
</nav>



    













</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        感谢老铁~
        <i class="icon icon-quote-right"></i>
    </h3>
    <ul class="reward-items">
        
        <li>
            <img src="/img/wechat.png" title="微信打赏二维码" alt="微信打赏二维码">
            <p>微信</p>
        </li>
        

        
        <li>
            <img src="/img/alipay.png" title="支付宝打赏二维码" alt="支付宝打赏二维码">
            <p>支付宝</p>
        </li>
        
    </ul>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>博客内容遵循<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
        </p>
    </div>
    <div class="bottom">
        <p>
            <span>Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a></span>
            <span>赵梦欢 &copy; 2015 - 2017</span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://zhaomenghuan.github.io/2017/04/01/Angular系列学习笔记（二）—基于gulp构建Angular单页面应用/&title=《Angular系列学习笔记（二）—— 基于gulp构建Angular单页面应用》 — 小青年博客&pic=https://zhaomenghuan.github.io/img/avatar.png" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://zhaomenghuan.github.io/2017/04/01/Angular系列学习笔记（二）—基于gulp构建Angular单页面应用/&title=《Angular系列学习笔记（二）—— 基于gulp构建Angular单页面应用》 — 小青年博客&source=小青年,小青年博客,前端开发,android,技术宅,菜鸟教程,一个神奇的博客。" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://zhaomenghuan.github.io/2017/04/01/Angular系列学习笔记（二）—基于gulp构建Angular单页面应用/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Angular系列学习笔记（二）—— 基于gulp构建Angular单页面应用》 — 小青年博客&url=https://zhaomenghuan.github.io/2017/04/01/Angular系列学习笔记（二）—基于gulp构建Angular单页面应用/&via=https://zhaomenghuan.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://zhaomenghuan.github.io/2017/04/01/Angular系列学习笔记（二）—基于gulp构建Angular单页面应用/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQ4AAAEOCAAAAABd2qZ5AAAD6klEQVR42u3ay27cQAwEwPz/TydArptVmmyuYyClk7HWY6Z0oIbTP37Ex8/fx/Tv1+P1v89Peb7D67XP55wdOHDgwIEjmGr++OdBv5vebjzP40wo8zniwIEDB45bjry4JmfujqTETseQzxEHDhw4cHw9RzK4aZHr7/a8qMOBAwcOHN+ZI19oNQu5fML9hwIOHDhw4Pgcx25ZNd0Q2hXvvDm4Gz8OHDhw4Ljl+Fyg4fv8/S3yHThw4MDxH3A0m0O78tYU4DzKsJsdDhw4cODoOZ4f0wTa8vPzAt+0FAcFGAcOHDhwFBxN4cyjD/nW1C7iMH1Vb8eDAwcOHDiOOJqwQl7MGpSm/Te4FgcOHDhwHHFMd17y0piX6rzYJxObvuDxdwcOHDhw4Ag4po/sz2libckLGLcLceDAgQNHzTFdPvUxgqSluPslKfmDdiQOHDhw4Fhx9LG2pHRNowzTLaUdXNRHxIEDBw4cNcfVAmy3TTVtOOb3H3xr4MCBAweOmiMvhNNNo/zaZjF2dQccOHDgwNFz5BtOCUGzmZS/jIYgmhcOHDhw4Cg4lqVouIRrtrJygoN4BA4cOHDgOOLIt4um5XA63Ga5mI/87Xhw4MCBA0fNkW8U5RtRfaAhbzVO+aLGKA4cOHDgKDj6MpYPtLn/VevwL9fiwIEDB44jjquQ3LTJmBf4/syoDYoDBw4cOI44dtGEJCiw25RqWoTTjbFlsgMHDhw4cMQceVvttlW3awv2DcdBcxAHDhw4cAw5+nDArnWYX9VE4qJR4cCBAweOmmM6oGlpnEYc8rI6LfbToB4OHDhw4Gg48hZhvxVULbFWjb/x7HDgwIEDR8ExDaIlTcBd6O1rIneDbw0cOHDgwLHiyKMMeanLl16DqEHQiMxf8zjcgAMHDhw4Yo6m0OaTyWNzu0VaE6E4W8LhwIEDB44XjvwxzTTyIMKu9O5eRvTtgAMHDhw44jtPG3bTRuFui+iq5ZfH6XDgwIEDxxVHcuo0cLabal7+8zHvAhM4cODAgWPH0RfCfMm0C9jlC8j8Bby9FgcOHDhwHHHs4nG7OF0ffcgJ8qfgwIEDB44rjt20m8K2Cxw0207jAwcOHDhwHEH0rcBpq+621ThdTP7hbjhw4MCBo+ZoCl7Sbtst2KbtwmTMu4UfDhw4cODYceTFdTftXawhoZ8GF6KXjQMHDhw4jjjyQpUX4KZ5d5YBjHFx4MCBA8e/5dgt4aYLvGk8Ih/teKcLBw4cOHB8gGMaa54OK7/b7S84cODAgeMTHH2IIV9c7eILTdhucAccOHDgwHHTMRusa5rwQf77FCjZ+tpteuHAgQMHjpjjFzCl2LvcZfJQAAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };



lazyScripts.push('//s95.cnzz.com/z_stat.php?id=1261860158&web_id=1261860158')

</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '小青年博客！';
            clearTimeout(titleTime);
        } else {
            document.title = '看似寻常最奇崛，成如容易却艰辛。';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



<script type="text/javascript">
    (function(p,u,s,h){
        p._pcq=p._pcq||[];
        p._pcq.push(['_currentTime',Date.now()]);
        s=u.createElement('script');
        s.type='text/javascript';
        s.async=true;
        s.src='https://cdn.pushcrew.com/js/84781173feeb9c46759523538d7dbfe0.js';
        h=u.getElementsByTagName('script')[0];
        h.parentNode.insertBefore(s,h);
    })(window,document);
</script>

</body>
</html>
